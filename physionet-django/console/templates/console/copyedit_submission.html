{% extends "console/base_console.html" %}

{% block title %}Copyedit Submission{% endblock %}

{% block local_js_top %}
<script>
  function copyToClipboard(str){
    var el = document.createElement('textarea');
    el.value = str;
    document.body.appendChild(el);
    el.select();
    document.execCommand('copy');
    document.body.removeChild(el);
  }
</script>
{% endblock %}

{% block content %}
<h1>Copyedit Project: {{ project }}</h1>
<hr><br>
<p>Make adjustments to the metadata and files. </p>
<p>Contact the authors via email to discuss changes.</p>
<p><button class="btn btn-primary" onclick="copyToClipboard('{{ author_emails }}')">Copy Emails to Clipboard</button></p>
<br>
{% include "console/project_info_card.html" %}

<div class="card">
  <div class="card-header">
    <ul class="nav nav-tabs card-header-tabs">
      <li class="nav-item">
        <a class="nav-link active" id="assignment-tab" data-toggle="tab" href="#assignment" role="tab" aria-controls="assignment" aria-selected="true">Edit Metadata</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" id="decision-tab" data-toggle="tab" href="#decision" role="tab" aria-controls="decision" aria-selected="false">Edit Files</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" id="revision-tab" data-toggle="tab" href="#revision" role="tab" aria-controls="revision" aria-selected="false">Complete Copyedit</a>
      </li>
    </ul>
  </div>
  <div class="card-body">
    {# Edit Metadata #}
    <div class="tab-content" id="tabContent">
      <div class="tab-pane fade show active" id="assigmnent" role="tabpanel" aria-labelledby="home-tab">
        {% if assignment_projects %}
          <p><button type="button" class="btn btn-primary btn-lg" data-toggle="modal" data-target="#assignModal">
        Assign Editor</button></p>
          <div class="table-responsive">
            <table class="table table-bordered">
              <thead>
                <tr>
                  <th>Project</th>
                  <th>Submitting Author</th>
                  <th>Submission Date</th>
                </tr>
              </thead>
              <tbody>
              {% for project in assignment_projects %}
                <tr>
                  <td><a href="{% url 'project_overview' project.slug %}">{{ project }}</a></td>
                  <td><a href="{% url 'public_profile' project.submitting_author.user.username %}">{{ project.submitting_author }}</a></td>
                  <td>{{ project.submission_datetime|date }}</td>
                </tr>
              {% endfor %}
              </tbody>
            </table>
          </div>
        {% else %}
          <p><i class="fas fa-check" style="color:green"></i> No projects to show.</p>
        {% endif %}
      </div>
      {# Edit Files #}
      <div class="tab-pane fade" id="publish" role="tabpanel" aria-labelledby="publish-tab">
        {% if publish_projects %}
          <div class="table-responsive">
            <table class="table table-bordered">
              <thead>
                <tr>
                  <th>Project</th>
                  <th>Submitting Author</th>
                  <th>Submission Date</th>
                  <th>Editor</th>
                  <th>Is Resubmission</th>
                </tr>
              </thead>
              <tbody>
              {% for project in publish_projects %}
                <tr>
                  <td><a href="{% url 'project_overview' project.slug %}">{{ project }}</a></td>
                  <td><a href="{% url 'public_profile' project.submitting_author.user.username %}">{{ project.submitting_author.user.username }}</a> - {{ project.submitting_author.user.email }}</td>
                  <td>{{ project.submission_datetime|date }}</td>
                </tr>
              {% endfor %}
              </tbody>
            </table>
          </div>
        {% else %}
          <p><i class="fas fa-check" style="color:green"></i> No projects to show.</p>
        {% endif %}
      </div>
      {# Complete Copyedit #}
      <div class="tab-pane fade" id="publish" role="tabpanel" aria-labelledby="publish-tab">
        {% if publish_projects %}
          <div class="table-responsive">
            <table class="table table-bordered">
              <thead>
                <tr>
                  <th>Project</th>
                  <th>Submitting Author</th>
                  <th>Submission Date</th>
                  <th>Editor</th>
                  <th>Is Resubmission</th>
                </tr>
              </thead>
              <tbody>
              {% for project in publish_projects %}
                <tr>
                  <td><a href="{% url 'project_overview' project.slug %}">{{ project }}</a></td>
                  <td><a href="{% url 'public_profile' project.submitting_author.user.username %}">{{ project.submitting_author.user.username }}</a> - {{ project.submitting_author.user.email }}</td>
                  <td>{{ project.submission_datetime|date }}</td>
                </tr>
              {% endfor %}
              </tbody>
            </table>
          </div>
        {% else %}
          <p><i class="fas fa-check" style="color:green"></i> No projects to show.</p>
        {% endif %}
      </div>
    </div>
  </div>
</div>


{% endblock %}
