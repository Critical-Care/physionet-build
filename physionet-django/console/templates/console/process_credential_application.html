{% extends "console/base_console.html" %}

{% load static %}

{% block title %}Process Credential Application - {{ app_user.username }}{% endblock %}

{% block local_js_top %}
<script type="text/javascript" src="{% static 'custom/js/copy-to-clipboard.js' %}"></script>
{% endblock %}

{% block content %}
<h1>Process Credential Application - {{ app_user.username }}</h1>
<hr>

<div class="card mb-3">
  <div class="card-header">
    Application Info
  </div>
  <div class="card-body">
    <div class="table-responsive">
      {% include "user/application_display_table.html" with user=app_user %}
    </div>
  </div>
</div>

<div class="card mb-3">
  <div class="card-header">
    Contact Reference
  </div>
  <div class="card-body">
    {% if application.reference_contact_datetime %}
      <p><i class="fas fa-envelope"></i> The reference was contacted on {{ application.reference_contact_datetime }}</p>
      {% if not application.reference_response_datetime %}
        <p><i class="fas fa-clock"></i> Awaiting reference response.</p>
      {% endif %}
    {% else %}
      <p>The reference has not been contacted.</p>
    {% endif %}
    {# Reference already responded #}
    {% if application.reference_response_datetime %}
      <p><i class="fas fa-check" style="color:green"></i> The reference verified the applicant on {{ application.reference_response_datetime }}</p>
    {% endif %}
      <form action="" method="post" class="form-signin">
        {% csrf_token %}
        <button class="btn btn-primary btn-fixed" name="contact_reference" type="submit">Contact Reference</button>
      </form>
  </div>
</div>

<div class="card mb-3">
  <div class="card-header">
    Process Application
  </div>
  <div class="card-body">

    <form action="" method="post" class="form-signin">
      {% csrf_token %}
      {% include "form_snippet.html" with form=process_credential_form %}
      <button class="btn btn-primary btn-lg" name="process_application" type="submit">Submit Response</button>
    </form>
  </div>
</div>
{% endblock %}
